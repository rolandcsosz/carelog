generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DB_URL")
}

model Admin {
  id       String  @id @default(uuid())
  name     String  @db.VarChar(51)
  email    String  @unique @db.VarChar(100)
  password String
}

model Caregiver {
  id       String  @id @default(uuid())
  name     String  @db.VarChar(50)
  email    String  @unique @db.VarChar(100)
  phone    String  @db.VarChar(15)
  password String

  recipientRelationships RecipientCaregiverRelationship[]
}

model Recipient {
  id                     String  @id @default(uuid())
  name                   String  @db.VarChar(50)
  email                  String  @unique @db.VarChar(100)
  phone                  String  @db.VarChar(15)
  address                String
  fourHandCareNeeded     Boolean  @default(false)
  caregiverNote          String
  password               String

  caregiverRelationships RecipientCaregiverRelationship[]
}

model RecipientCaregiverRelationship {
  id           String     @id @default(uuid())
  recipient    Recipient  @relation(fields: [recipientId], references: [id], onDelete: Cascade)
  recipientId  String
  caregiver    Caregiver  @relation(fields: [caregiverId], references: [id], onDelete: Cascade)
  caregiverId  String

  schedules Schedule[]
  todos     Todo[]

  @@unique([recipientId, caregiverId])
}

model Schedule {
  id             String     @id @default(uuid())
  relationship   RecipientCaregiverRelationship @relation(fields: [relationshipId], references: [id], onDelete: Cascade)
  relationshipId String
  date           DateTime   @db.Date
  startTime      DateTime   @db.Time
  endTime        DateTime   @db.Time
}

model TaskType {
  id       String   @id @default(uuid())
  type     String   @unique
  subtasks Subtask[]
}

model Subtask {
  id         String   @id @default(uuid())
  title      String
  taskType   TaskType @relation(fields: [taskTypeId], references: [id], onDelete: SetNull)
  taskTypeId String
  todos      Todo[]
}

model Todo {
  id             String     @id @default(uuid())
  subtask        Subtask    @relation(fields: [subtaskId], references: [id], onDelete: Cascade)
  subtaskId      String
  relationship   RecipientCaregiverRelationship @relation(fields: [relationshipId], references: [id], onDelete: Cascade)
  relationshipId String
  sequenceNumber Int
  done           Boolean    @default(false)
}

model MimeType {
  id          String @id @default(uuid())
  type        String
  googleType  String
}
